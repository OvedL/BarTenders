<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Plan Event â€¢ Bar-Tenders</title>
  <link href="Bar-Tenders.css" rel="stylesheet">
  <style>
    /* Minimal, neutral styling (works even if styles.css is missing) */
    :root { --brand:#7a0b25; --paper:#f7f3e3; --ink:#222; }
    body { font-family: system-ui, Arial, sans-serif; margin:0; color:var(--ink); background:#faf8f5; }
    header { background:var(--paper); border-bottom: 4px solid var(--brand); padding:16px 24px; }
    h1 { margin:0; letter-spacing:1px; }
    main { max-width: 960px; margin: 24px auto 64px; padding: 0 16px; }
    .card { background:white; border:1px solid #ddd; border-radius:12px; padding:20px; margin-bottom:18px; }
    .section-title { margin:0 0 12px; color:var(--brand); letter-spacing:1px; }
    .grid { display:grid; grid-template-columns: repeat(12, 1fr); gap: 12px; }
    .col-6 { grid-column: span 6; } .col-4 { grid-column: span 4; } .col-8 { grid-column: span 8; }
    .col-12 { grid-column: span 12; }
    label { display:block; font-weight:600; margin-bottom:6px; }
    input, select, textarea { width:100%; padding:10px; border:1px solid #ccc; border-radius:8px; background:#fff; }
    textarea { min-height:100px; resize:vertical; }
    .note { font-size:12px; color:#666; margin-top:4px; }
    .actions { display:flex; gap:12px; justify-content:flex-end; margin-top:8px; }
    .btn { border:0; border-radius:999px; padding:12px 18px; cursor:pointer; font-weight:700; }
    .btn-primary { background:var(--brand); color:white; }
    .btn-secondary { background:#e8e5de; }
    @media (max-width: 720px){ .col-6,.col-4,.col-8{grid-column: span 12;} }
  </style>
</head>
<body>
  <header>
      <div class="branding">
          <a href="index.html"><img src="images/logoNoWords.png" alt="Bar-Tenders Logo" width="150" class="logo"></a>
          <img src="images/title.png" alt="Bar-Tenders" width="300" class="title">
      </div>

      <nav>
          <a href="index.html">Home</a>
          <a href="plan-event.html">Plan Event</a>
          <a href="interested.html">Interested in Bartending</a>
          <a href="manage_bartenders.html" class="manager-only" hidden>Manage Bartenders</a>
          <a href="signin.html" class="guest-only">Sign In</a>
          <div class="profile-dropdown auth-only" hidden>
              <img src="images/defaultPFP.png" alt="Profile" width="30" class="profile-btn">
              <div class="dropdown-content">
                  <a href="profile.html">Profile</a>
                  <a href="#" id="logoutLink">Logout</a>
              </div>
          </div>
      </nav>

  </header>

  <main>
    <h1>Plan Your Event</h1>
    <form action="/plan-event" method="POST" class="grid">
      <!-- Event Details -->
      <section class="card col-12">
        <h2 class="section-title">Event Details</h2>
        <div class="grid">
          <div class="col-8">
            <label for="event_name">Event Name</label>
            <input id="event_name" name="event_name" type="text" placeholder="Ex: Lopez Wedding Reception" required />
          </div>
          <div class="col-4">
            <label for="guest_count">Guest Count</label>
            <input id="guest_count" name="guest_count" type="number" min="1" placeholder="e.g. 120" required />
          </div>

          <div class="col-4">
            <label for="event_date">Date</label>
            <input id="event_date" name="event_date" type="date" required />
          </div>
          <div class="col-4">
            <label for="start_time">Start Time</label>
            <input id="start_time" name="start_time" type="time" required />
          </div>
          <div class="col-4">
            <label for="end_time">End Time</label>
            <input id="end_time" name="end_time" type="time" required />
          </div>

          <div class="col-6">
            <label for="venue_name">Venue Name</label>
            <input id="venue_name" name="venue_name" type="text" placeholder="Ex: Harmony Hall" />
          </div>
          <div class="col-6">
            <label for="venue_type">Venue Type</label>
            <select id="venue_type" name="venue_type">
              <option value="">Select one</option>
              <option>Indoor</option>
              <option>Outdoor</option>
              <option>Both/Unknown</option>
            </select>
          </div>

          <div class="col-6">
            <label for="event_tier">Event Tier</label>
            <select id="event_tier" name="event_tier" required>
              <option value="">Choose tier</option>
              <option>Tier 1</option>
              <option>Tier 2</option>
              <option>Tier 3</option>
            </select>
            <div class="note">Tier = size/complexity level you showed on the homepage.</div>
          </div>

          <div class="col-6">
            <label for="drink_package">Drink Package</label>
            <select id="drink_package" name="drink_package" required>
              <option value="">Choose package</option>
              <option>Wet Bar</option>
              <option>Cocktail Bar</option>
              <option>Full Bar</option>
            </select>
          </div>

          <div class="col-6">
            <label for="budget">Estimated Budget (USD)</label>
            <input id="budget" name="budget" type="number" min="0" step="1" placeholder="e.g. 1500" />
          </div>
          <div class="col-6">
            <label for="bartender_count"># of Bartenders</label>
            <input id="bartender_count" name="bartender_count" type="number" min="1" placeholder="e.g. 2" />
          </div>
        </div>
      </section>

      <!-- Add-Ons -->
      <section class="card col-12">
        <h2 class="section-title">Add-Ons</h2>
        <div class="grid">
          <div class="col-6">
            <label for="glassware">Glassware</label>
            <select id="glassware" name="glassware">
              <option value="">No preference</option>
              <option>Disposable</option>
              <option>Real glass</option>
              <option>Mixed</option>
            </select>
          </div>
          <div class="col-6">
            <label for="ice_mgmt">Ice & Cooling</label>
            <select id="ice_mgmt" name="ice_mgmt">
              <option value="">We will provide</option>
              <option>Provide ice & coolers</option>
              <option>Provide ice only</option>
              <option>Provide coolers only</option>
            </select>
          </div>
          <div class="col-12">
            <label for="signature_cocktail">Signature Cocktail (optional)</label>
            <input id="signature_cocktail" name="signature_cocktail" type="text" placeholder="Ex: Hibiscus Paloma" />
          </div>
          <div class="col-12">
            <label for="notes">Notes / Special Requests</label>
            <textarea id="notes" name="notes" placeholder="Allergies, theme, dress code, mocktails, etc."></textarea>
          </div>
        </div>
      </section>

      <!-- Contact -->
      <section class="card col-12">
        <h2 class="section-title">Primary Contact</h2>
        <div class="grid">
          <div class="col-6">
            <label for="full_name">Full Name</label>
            <input id="full_name" name="full_name" type="text" required />
          </div>
          <div class="col-6">
            <label for="phone">Phone</label>
            <input id="phone" name="phone" type="tel" placeholder="(555) 555-5555" required />
          </div>
          <div class="col-12">
            <label for="email">Email</label>
            <input id="email" name="email" type="email" placeholder="you@example.com" required />
          </div>
        </div>
        <div class="actions">
          <button type="reset" class="btn btn-secondary">Clear</button>
          <button type="submit" class="btn btn-primary">Submit Request</button>
        </div>
      </section>
    </form>
  </main>
  <script>
    //dynamic nav bar
    async function refreshNav() {
      try {
        const res = await fetch("/api/session"); // backend must provide this
        const { loggedIn, credentialID } = await res.json();

        console.log("Session Status:", {loggedIn, credentialID});

        document.querySelectorAll(".auth-only").forEach(el => el.hidden = !loggedIn);
        document.querySelectorAll(".guest-only").forEach(el => el.hidden = loggedIn);
        if ( credentialID >= 3 ) {
            document.querySelectorAll(".manager-only").forEach(el => el.hidden = !loggedIn);
        }
      } catch (e) {
        console.error("Session check failed", e);
      }
    }

     //logout
    document.addEventListener("click", async (e) => {
      if (e.target.id === "logoutLink") {
        e.preventDefault();
        const res = await fetch("/api/logout", { method: "POST" });
        const data = await res.json();

        if (data.success) {
            window.location.href = data.redirect;
        } else {
            alert("Logout failed, please try again.");
        }
      }
    });


    refreshNav();
  </script>
</body>
</html>
